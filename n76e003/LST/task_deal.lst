C51 COMPILER V9.56.0.0   TASK_DEAL                                                         12/29/2017 19:35:16 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE TASK_DEAL
OBJECT MODULE PLACED IN .\Output\task_deal.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE N76E003\Code\task_deal.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Include;.\In
                    -clude) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\LST\task_deal.lst) TABS(2) OBJECT(.\Output\task_deal.obj)

line level    source

   1          #define task_GLOBALS
   2          #include "task_deal.h"
   3          #include "sysinit.h"
   4          
   5          bit led_flag;
   6          UINT16 sys_flag=0x00;
   7          UINT8 VOL_LED=0;
   8          extern  UINT8 source_in,mode_in,VOL_level;
   9          extern  bit Recive_flag;
  10          extern  void  NPCA110P_init(void);
  11          extern  void __delay_10ms( UINT16 u16CNT );
  12          
  13          extern  void  NPCA110P_SOURCE(void);
  14          extern  void  NPCA110P_VOL(void);
  15          //extern  void  NPCA110P_VOL_B(void);
  16          extern  void  NPCA110P_MODE(void);
  17          
  18          void  POWER_ON_OFF(void);
  19          void  SYS_SOURCE(void);
  20          void  SYS_VOL_A(void);
  21          void  SYS_VOL_B(void);
  22          void  SYS_MODE(void);
  23          
  24          void  POWER_ON_OFF(void)
  25          {
  26   1        if((sys_flag & sys_power_on)&&(power_flag == 1))
  27   1        {
  28   2          clr_EA;
  29   2          MUTE = 1;
  30   2          ST_BY = 1;
  31   2          sys_flag = sys_flag & (~sys_power_on);
  32   2          sys_flag = sys_flag | sys_power_off;
  33   2          __delay_10ms(20);
  34   2          set_EA;
  35   2          set_TR0;                             //Timer0 run
  36   2          sys_flag = sys_flag | sys_mode;
  37   2          mode_in--;
  38   2          SYS_MODE();
  39   2      //    sys_flag = sys_flag | sys_source;
  40   2      //    source_in--;
  41   2      //    SYS_SOURCE();
  42   2      //    sys_flag = sys_flag | sys_volA;
  43   2      //    VOL_level--;
  44   2      //    SYS_VOL_A();
  45   2          MUTE = 0;
  46   2          
  47   2          
  48   2      //    set_TR0;
  49   2        }
  50   1        else if((sys_flag & sys_power_off)&&(power_flag == 0))
  51   1        {
  52   2          clr_EA;
  53   2          MUTE = 1;
  54   2          ST_BY = 0;
C51 COMPILER V9.56.0.0   TASK_DEAL                                                         12/29/2017 19:35:16 PAGE 2   

  55   2          sys_flag = sys_flag & (~sys_power_off);
  56   2          sys_flag = sys_flag | sys_power_on;
  57   2          AUX1_LED = 1;AUX2_LED = 1;BT_LED = 1;
  58   2          MUSIC_LED = 1;MOVIE_LED = 1;VOICE_LED = 1;
  59   2          __delay_10ms(30);
  60   2          set_EA;
  61   2          
  62   2      //    set_TR0;
  63   2        }
  64   1        
  65   1      }
  66          
  67          void  SYS_SOURCE(void)
  68          {
  69   1        if(sys_flag & sys_source)
  70   1        {
  71   2          sys_flag = sys_flag & (~sys_source); 
  72   2          BT_POWER = 0;
  73   2          source_in++;
  74   2          if(source_in>3)
  75   2          {
  76   3            source_in = 1;      
  77   3          }
  78   2          else if(source_in==3)   
  79   2          {
  80   3            BT_POWER = 1;
  81   3          }
  82   2          NPCA110P_SOURCE();
  83   2          
  84   2      //    set_TR0;
  85   2          led_flag = 1;
  86   2        }
  87   1      }
  88          
  89          void  SYS_MODE(void)
  90          {
  91   1        if(sys_flag & sys_mode)
  92   1        {
  93   2          sys_flag = sys_flag & (~sys_mode);
  94   2          mode_in++;
  95   2          if(mode_in>3)
  96   2          {
  97   3            mode_in = 1;      
  98   3          }
  99   2          NPCA110P_init();
 100   2          
 101   2      //    set_TR0;
 102   2          led_flag = 1;
 103   2        }
 104   1      }
 105          
 106          void  SYS_VOL_A(void)
 107          {
 108   1        if(sys_flag & sys_volA)
 109   1        {
 110   2          sys_flag = sys_flag & (~sys_volA);
 111   2          if(VOL_level>=30)
 112   2          {
 113   3            VOL_level = 30;
 114   3            return;
 115   3          }
 116   2          VOL_level++;
C51 COMPILER V9.56.0.0   TASK_DEAL                                                         12/29/2017 19:35:16 PAGE 3   

 117   2          NPCA110P_VOL();
 118   2          
 119   2      //    set_TR0;
 120   2          led_flag = 1;
 121   2          VOL_LED = 1;
 122   2        }
 123   1      }
 124          
 125          void  SYS_VOL_B(void)
 126          {
 127   1        if(sys_flag & sys_volB)
 128   1        {
 129   2          sys_flag = sys_flag & (~sys_volB);
 130   2          if((VOL_level<=0)||(VOL_level>30))
 131   2          {
 132   3            VOL_level = 0;
 133   3            return;
 134   3          }
 135   2          VOL_level--;
 136   2          NPCA110P_VOL();
 137   2          
 138   2      //    set_TR0;
 139   2          led_flag = 1;
 140   2          VOL_LED = 1;
 141   2        }
 142   1      }
 143          
 144          void  GPIO_MUTE(void)
 145          {
 146   1        if(Recive_flag)
 147   1        {
 148   2          MUTE = ~MUTE;
 149   2        }
 150   1      }
 151          
 152          void  LED_DISPLAY(void)
 153          {
 154   1        if(led_flag)
 155   1        {
 156   2          if(VOL_LED)
 157   2          {
 158   3            AUX1_LED = 1;AUX2_LED = 1;BT_LED = 1;
 159   3            __delay_10ms(20);
 160   3          }
 161   2          if(source_in == 1)
 162   2          {
 163   3            AUX1_LED = 0;AUX2_LED = 1;BT_LED = 1;
 164   3            __delay_10ms(3);
 165   3          }
 166   2          if(source_in == 2)
 167   2          {
 168   3            AUX1_LED = 1;AUX2_LED = 0;BT_LED = 1;
 169   3            __delay_10ms(3);
 170   3          }
 171   2          if(source_in == 3)
 172   2          {
 173   3            AUX1_LED = 1;AUX2_LED = 1;BT_LED = 0;
 174   3            __delay_10ms(3);
 175   3          }
 176   2          if(mode_in == 1)
 177   2          {
 178   3            MUSIC_LED = 0;MOVIE_LED = 1;VOICE_LED = 1;
C51 COMPILER V9.56.0.0   TASK_DEAL                                                         12/29/2017 19:35:16 PAGE 4   

 179   3            __delay_10ms(3);
 180   3          }
 181   2          if(mode_in == 2)
 182   2          {
 183   3            MUSIC_LED = 1;MOVIE_LED = 0;VOICE_LED = 1;
 184   3            __delay_10ms(3);
 185   3          }
 186   2          if(mode_in == 3)
 187   2          {
 188   3            MUSIC_LED = 1;MOVIE_LED = 1;VOICE_LED = 0;
 189   3            __delay_10ms(3);
 190   3          }
 191   2          led_flag = 0;
 192   2        }
 193   1        
 194   1      }
 195          
 196          void  IR_EVENT(void)
 197          {
 198   1        switch(KEY_data)
 199   1        {
 200   2          case 0x01:              //BASS+
 201   2          {
 202   3              break;
 203   3          }
 204   2                    
 205   2          case 0x02:              //BASS-
 206   2          {
 207   3            break;
 208   3          }
 209   2                  
 210   2          case 0x03:              //TREBLE+
 211   2          break;
 212   2                  
 213   2          case 0x04:              //TREBLE-
 214   2          break;
 215   2                  
 216   2          case 0x0a:              //??BLUETOOTH??LINE IN
 217   2          break;
 218   2                  
 219   2          case 0x0b:              //AUX IN
 220   2          break;
 221   2                              
 222   2          case 0x0c:              //BLUETOOTH
 223   2          break;
 224   2      
 225   2          case 0x0d:              //OPTICAL
 226   2          break;
 227   2                  
 228   2          case 0x0E:              //COAXIAL
 229   2          break;
 230   2      
 231   2          case 0x12:              //VOL+
 232   2          break;
 233   2      
 234   2          case 0x13:              //VOL-
 235   2          break;
 236   2      
 237   2          case 0x14:              //ON-OFF
 238   2          break;
 239   2      
 240   2          case 0x15:              //MUTE
C51 COMPILER V9.56.0.0   TASK_DEAL                                                         12/29/2017 19:35:16 PAGE 5   

 241   2          break;
 242   2      
 243   2          case 0x18:              //HDMI
 244   2          break;
 245   2        }
 246   1      }
 247          
 248          
 249          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    355    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
